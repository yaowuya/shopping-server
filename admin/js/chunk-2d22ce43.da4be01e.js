(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22ce43"],{f4ba:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"category-list p-5"},[a("el-row",{staticClass:"mt-10 px-10"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline}},[a("el-form-item",{attrs:{label:"分类名称"}},[a("el-input",{attrs:{placeholder:"分类名称"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,"name",t)},expression:"formInline.name"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.queryCategory}},[e._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{type:"info"},on:{click:function(t){return e.addCategory("ruleForm")}}},[e._v("添加")])],1)],1)],1),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","max-height":"400"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"name",label:"分类名称","min-width":"120"}}),a("el-table-column",{attrs:{prop:"admin",label:"管理员","min-width":"120"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑 ")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除 ")])]}}])})],1)],1),a("el-row",{staticClass:"mt-10"},[a("el-pagination",{staticClass:"f-right",attrs:{"current-page":e.pageNum,"page-sizes":e.pageSizeList,"page-size":e.pageSize,"pager-count":e.pageCount,background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogVisible,width:"50%",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"ruleForm",attrs:{model:e.dialogForm,rules:e.rules,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[a("el-input",{model:{value:e.dialogForm.name,callback:function(t){e.$set(e.dialogForm,"name",t)},expression:"dialogForm.name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提 交")])],1)],1)],1)},r=[],i=(a("a4d3"),a("4de4"),a("b0c0"),a("e439"),a("dbb4"),a("b64b"),a("d3b7"),a("159b"),a("96cf"),a("ade3")),o=a("2f62"),s=a("5d2d");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var u={name:"category",data:function(){return{formInline:{name:""},tableData:[],multipleSelection:[],textMap:{update:"编辑",create:"添加"},dialogStatus:"create",dialogVisible:!1,dialogForm:{name:"",admin:""},dialogId:null,rules:{name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},parents:[],pageNum:1,pageSize:10,pageSizeList:[10,20,50,100,200],pageCount:11,total:0}},computed:c({},Object(o["c"])(["name"])),created:function(){this.dialogForm.admin=""===this.name?Object(s["a"])("userName"):this.name,this.onSearch()},methods:{handleEdit:function(e,t){var a=this;this.dialogVisible=!0,this.dialogStatus="update",this.dialogId=t._id,this.$nextTick((function(){a.dialogForm=Object.assign({},t),a.empty("ruleForm")}))},handleDelete:function(e,t){var a=this;this.$confirm('是否确定要删除分类 "'.concat(t.name,'"'),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return regeneratorRuntime.async((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(a.$http.delete("/rest/category/".concat(t._id)));case 2:a.$message({type:"success",message:"删除成功!"}),a.onSearch();case 4:case"end":return e.stop()}}))})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))},handleSelectionChange:function(e){this.multipleSelection=e},handleSizeChange:function(e){console.log("每页 ".concat(e," 条")),this.pageSize=e,this.onSearch()},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.pageNum=e,this.onSearch()},queryCategory:function(){this.pageNum=1,this.onSearch()},addCategory:function(e){var t=this;this.dialogVisible=!0,this.dialogStatus="create",this.dialogId=null,delete this.dialogForm._id,this.$nextTick((function(){t.empty(e)}))},onSearch:function(){var e;return regeneratorRuntime.async((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.$http.post("/book/category/pagination",{pageNum:this.pageNum,pageSize:this.pageSize,name:this.formInline.name}));case 2:e=t.sent,this.tableData=e.data.data,this.total=e.data.count;case 5:case"end":return t.stop()}}),null,this)},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){var a;return regeneratorRuntime.async((function(n){while(1)switch(n.prev=n.next){case 0:if(!e){n.next=14;break}if(a=null,!t.dialogId){n.next=8;break}return n.next=5,regeneratorRuntime.awrap(t.$http.put("/rest/category/".concat(t.dialogId),t.dialogForm));case 5:a=n.sent,n.next=11;break;case 8:return n.next=10,regeneratorRuntime.awrap(t.$http.post("/rest/category",t.dialogForm));case 10:a=n.sent;case 11:console.log(a),n.next=16;break;case 14:return t.$message({type:"error",message:"请输入完整信息"}),n.abrupt("return",!1);case 16:t.$message({type:"success",message:"保存成功"}),t.dialogVisible=!1,t.onSearch();case 19:case"end":return n.stop()}}))}))},empty:function(e){this.$refs[e]&&(this.$refs[e].resetFields(),this.$refs[e].clearValidate())},resetForm:function(e){this.dialogVisible=!1,this.empty(e)}}},m=u,d=a("2877"),g=Object(d["a"])(m,n,r,!1,null,"376b61b0",null);t["default"]=g.exports}}]);